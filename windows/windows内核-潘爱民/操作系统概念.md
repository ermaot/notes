# 操作系统基础
### 操作系统是一种特殊的软件
- 管理硬件资源
1. 使用机器能理解的语言
2. 与硬件体系结构相关
3. C语言与汇编
- 向上提供软件服务


### ==1. 操作系统的硬件资源==
#### 计算资源（CPU）
1. 合理安排与调度：**任务调度**。（==进程==与==线程==；==进程调==度与==线程调度==）
2. 任务切换与恢复：**中断**
#### 存储资源（内存和外存）
1. 内存：主存，RAM随机访问存储器；系统总线访问
2. 外存：辅助存储器：IO访问
3. 虚拟内存（物理内存映射（主要是硬件控制）；换入换出算法（主要是操作系统））
#### 其他资源
##### 键盘，鼠标，显示器，打印机
##### 通过IO访问
1. cpu通过指令控制IO设备（in/out指令（小数据量）；设备寄存器，CPU port访问）
2. IO设备通知CPU发生了特定的事情
    - cpu轮询
    - 设备中断机制（设备产生中断；全局中断号；共享中断号与设备中断号协商）
3. 系统主存与设备之间传输数据
    - 小数据量: in/out指令、映射一段地址到设备中（访问地址即访问设备）    
    - 大量: DMA（可能会与cpu争用总线）

#### IO模型
屏蔽IO设备的不同，统一的框架
- 对上：为应用程序提供访问接口
- 对下：提供访问硬件的能力

### ==2. 为应用程序提供运行环境==
#### 对运行的任务做必要的抽象
    - 进程与线程（windows：线程是基本任务单位；unix：进程是基本任务单位）
    - 任务并发
    - 任务调度（进程调度，线程调度；调度算法：windows抢占式任务调度）
#### 任务之间逻辑关系（即时间先后、资源争用的任务的有序进行）
1. 同步机制
    - 互斥体（mutex）
    - 信号量（semaphore）
    - 临界区（critical section）
2. 进程间通信（IPC，inter process communication）
    - 任务的执行空间（隔离）
    - 进程间通信（互通）
3. 句柄（可访问的抽象设备）
    - 打开设备获得句柄，向设备发送命令（读写设备），关闭设备
4. 特殊设备：磁盘
    - 文件系统（file system）：树状名字空间

### ==3. windows历史==
80年代后期ms-dos
1. windows 95/98/me
2. windows NT （1988年开始）
目标：真正32bit 抢占式调度 虚拟内存的网络操作系统，多硬件体系，多平台
设计者：David Culter
成果：体系结构整齐、先进，考虑了扩展性、安全性


### ==4.杂谈==
##### 宏内核（macrokernel）与微内核（microlernel）
- 宏内核：基本的OS服务运行于同一内核空间中，包括设备驱动程序的服务
- 微内核：最小系统服务由内核实现，其余在用户进程中实现


  /  |宏内核（主流） | 微内核
---|---|---
定义 | 基本的OS服务运行于同一内核空间中 |最小系统服务由内核实现
优点 | 内核操作在特权模式下进行，组件之间通过函数调用通信，效率高 |易于维护，易于验证和测试
缺点 | 系统组件与设备驱动在同一空间，容易崩溃；依赖性强，复杂性高，维护困难 |模式切换，开销大，性能低
典型例子 | windows,unix |minix

[超微内核](https://blog.csdn.net/u013178472/article/details/81115080)
#### 虚拟化（visualization）
- 控制程序VMM（virtual machine monitor）为客体软件（guest software）建立虚拟环境（虚拟机）
- vmware不用硬件指令，使用二进制代码翻译自动修改x86中的指令，达到完全虚拟化